<header class="header">
    <div class="container">
        <nav class="nav">
            <!-- Logo -->
            <div class="nav-brand">
                <a href="#" class="brand-link">
                    <div class="brand-icon">
                        <img class="icon-xl" src="/logo.png" alt="">
                    </div>
                    <span class="brand-text">SatendraCoder</span>
                </a>
            </div>

            <!-- Desktop Navigation -->
            <div class="nav-menu">
                <div class="nav-items">
                    <div *ngFor="let item of menuItems" class="nav-item" [class.active]="activeMenu() === item.label">
                        <button class="nav-link" (click)="toggleMenu(item.label)">
                            <svg *ngIf="item.icon" class="icon icon-sm" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path [attr.d]="getIconPath(item.icon)" />
                            </svg>
                            {{ item.label }}
                            <svg class="icon icon-sm chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="6,9 12,15 18,9" />
                            </svg>
                        </button>

                        @if (item.items && activeMenu() === item.label) {
                        <!-- Mega Menu Dropdown -->
                        <div class="mega-menu animate-fade-in">
                            <div class="mega-menu-content">
                                <div class="mega-menu-grid">
                                    <div *ngFor="let subItem of item.items" class="mega-menu-item">
                                        <a [href]="subItem.href" class="mega-menu-link">
                                            <div class="mega-menu-icon">
                                                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                    stroke-width="2">
                                                    <path [attr.d]="getIconPath(subItem.icon || 'default')" />
                                                </svg>
                                            </div>
                                            <div class="mega-menu-text">
                                                <div class="mega-menu-title">
                                                    {{ subItem.label }}
                                                    @if (subItem.badge) {
                                                    <span class="badge">{{ subItem.badge }}</span>
                                                    }
                                                </div>
                                                @if (subItem.description) {
                                                <div class="mega-menu-description">{{ subItem.description }}</div>
                                                }
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        }
                    </div>
                </div>
                <div>
                    <li style="list-style: none; margin:0px 10px;"><a href="" style="text-decoration: none;">About
                            us</a></li>
                </div>
                <div>
                    <li style="list-style: none;margin:0px 10px;"><a href="" style="text-decoration: none;">Job &
                            Internship</a></li>
                </div>
            </div>

            <!-- User Actions -->
            <div class="nav-actions">
                @if (!isLoggedIn()) {
                <div class="auth-buttons">
                    <button class="btn btn-ghost" (click)="showLogin()">Login</button>
                    <button class="btn btn-primary" (click)="showRegister()">Start Free</button>
                </div>
                }

                @if (isLoggedIn()) {
                <div class="user-menu" (click)="toggleUserMenu()">
                    <button class="user-button">
                        <div class="user-avatar">
                            @if (currentUser()?.avatar) {
                            <img [src]="currentUser()!.avatar" [alt]="currentUser()?.name">
                            } @else {
                            <span class="avatar-placeholder">{{ getInitials(currentUser()?.name || '') }}</span>
                            }
                        </div>
                        <span class="user-name">{{ currentUser()?.name }}</span>
                        <svg class="icon icon-sm chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="6,9 12,15 18,9" />
                        </svg>
                    </button>

                    @if (showUserDropdown()) {
                    <div class="user-dropdown animate-fade-in">
                        <div class="user-dropdown-header">
                            <div class="user-info">
                                <div class="user-name-large">{{ currentUser()?.name }}</div>
                                <div class="user-email">{{ currentUser()?.email }}</div>
                            </div>
                        </div>
                        <div class="user-dropdown-divider"></div>
                        <div class="user-dropdown-items">
                            <a href="#" class="user-dropdown-item">
                                <svg class="icon icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                                    <circle cx="12" cy="7" r="4" />
                                </svg>
                                Profile & Settings
                            </a>
                            <a href="#" class="user-dropdown-item">
                                <svg class="icon icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <circle cx="12" cy="12" r="3" />
                                    <path d="M12 1v6m0 6v6" />
                                    <path d="m15.4 12 3.5-6-3.5-6" />
                                    <path d="m8.6 12-3.5 6 3.5 6" />
                                </svg>
                                Preferences
                            </a>
                            <a href="#" class="user-dropdown-item">
                                <svg class="icon icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                                    <circle cx="12" cy="16" r="1" />
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                                </svg>
                                Billing & Usage
                            </a>
                            <div class="user-dropdown-divider"></div>
                            <button class="user-dropdown-item logout" (click)="logout()">
                                <svg class="icon icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                                    <polyline points="16,17 21,12 16,7" />
                                    <line x1="21" y1="12" x2="9" y2="12" />
                                </svg>
                                Sign Out
                            </button>
                        </div>
                    </div>
                    }
                </div>
                }

                <!-- Mobile Menu Toggle -->
                <button class="mobile-menu-toggle" (click)="toggleMobileMenu()">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="3" y1="6" x2="21" y2="6" />
                        <line x1="3" y1="12" x2="21" y2="12" />
                        <line x1="3" y1="18" x2="21" y2="18" />
                    </svg>
                </button>
            </div>
        </nav>
    </div>

    <!-- Mobile Menu Overlay -->
    @if (showMobileMenu()) {
    <div class="mobile-menu-overlay" (click)="closeMobileMenu()">
        <div class="mobile-menu animate-slide-in" (click)="$event.stopPropagation()">
            <div class="mobile-menu-header">
                <div class="brand-link">
                    <div class="brand-icon">
                        <img src="/logo.png" alt="logo" class="icon-xl">
                    </div>
                    <span class="brand-text">SatendraCoder</span>
                </div>
                <button class="mobile-menu-close" (click)="closeMobileMenu()">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18" />
                        <line x1="6" y1="6" x2="18" y2="18" />
                    </svg>
                </button>
            </div>
            <div class="mobile-menu-content">
                <div *ngFor="let item of menuItems" class="mobile-menu-section">
                    <div class="mobile-menu-title">{{ item.label }}</div>
                    <div *ngFor="let subItem of item.items" class="mobile-menu-item">
                        <a [href]="subItem.href" class="mobile-menu-link">{{ subItem.label }}</a>
                    </div>
                </div>

                <div class="mobile-menu-actions">
                    @if (!isLoggedIn()) {
                    <button class="btn btn-primary btn-full" (click)="showRegister()">Start Free</button>
                    <button class="btn btn-ghost btn-full" (click)="showLogin()">Login</button>
                    } @else {
                    <button class="btn btn-ghost btn-full" (click)="logout()">Sign Out</button>
                    }
                </div>
            </div>
        </div>
    </div>
    }
</header>